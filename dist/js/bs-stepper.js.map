{"version":3,"file":"bs-stepper.js","sources":["../../src/js/polyfill.js","../../src/js/util.js","../../src/js/listeners.js","../../src/js/index.js"],"sourcesContent":["let matches = window.Element.prototype.matches\nlet closest = (element, selector) => element.closest(selector)\nlet WinEvent = (inType, params) => new window.Event(inType, params)\nlet createCustomEvent = (eventName, params) => {\n  const cEvent = new window.CustomEvent(eventName, params)\n\n  return cEvent\n}\n\n/* istanbul ignore next */\nfunction polyfill () {\n  if (!window.Element.prototype.matches) {\n    matches = window.Element.prototype.msMatchesSelector ||\n      window.Element.prototype.webkitMatchesSelector\n  }\n\n  if (!window.Element.prototype.closest) {\n    closest = (element, selector) => {\n      if (!document.documentElement.contains(element)) {\n        return null\n      }\n\n      do {\n        if (matches.call(element, selector)) {\n          return element\n        }\n\n        element = element.parentElement || element.parentNode\n      } while (element !== null && element.nodeType === 1)\n\n      return null\n    }\n  }\n\n  if (!window.Event || typeof window.Event !== 'function') {\n    WinEvent = (inType, params) => {\n      params = params || {}\n      const e = document.createEvent('Event')\n      e.initEvent(inType, Boolean(params.bubbles), Boolean(params.cancelable))\n      return e\n    }\n  }\n\n  if (typeof window.CustomEvent !== 'function') {\n    const originPreventDefault = window.Event.prototype.preventDefault\n\n    createCustomEvent = (eventName, params) => {\n      const evt = document.createEvent('CustomEvent')\n\n      params = params || { bubbles: false, cancelable: false, detail: null }\n      evt.initCustomEvent(eventName, params.bubbles, params.cancelable, params.detail)\n      evt.preventDefault = function () {\n        if (!this.cancelable) {\n          return\n        }\n\n        originPreventDefault.call(this)\n        Object.defineProperty(this, 'defaultPrevented', {\n          get: function () { return true }\n        })\n      }\n\n      return evt\n    }\n  }\n}\n\npolyfill()\n\nexport {\n  closest,\n  WinEvent,\n  createCustomEvent\n}\n","import { WinEvent, createCustomEvent } from './polyfill'\n\nconst MILLISECONDS_MULTIPLIER = 1000\n\nconst transitionEndEvent = 'transitionend'\nconst customProperty = 'bsStepper'\n\nconst show = (stepperNode, indexStep, options) => {\n  const stepper = stepperNode[customProperty]\n\n  if (stepper._steps[indexStep].classList.contains(options.classNames.active) || stepper._stepsContents[indexStep].classList.contains(options.classNames.active)) {\n    return\n  }\n\n  const showEvent = createCustomEvent('show.bs-stepper', {\n    cancelable: true,\n    detail: {\n      indexStep\n    }\n  })\n  stepperNode.dispatchEvent(showEvent)\n\n  const activeStep = stepper._steps.filter(step => step.classList.contains(options.classNames.active))\n  const activeContent = stepper._stepsContents.filter(content => content.classList.contains(options.classNames.active))\n\n  if (showEvent.defaultPrevented) {\n    return\n  }\n\n  if (activeStep.length) {\n    activeStep[0].classList.remove(options.classNames.active)\n  }\n  if (activeContent.length) {\n    activeContent[0].classList.remove(options.classNames.active)\n    activeContent[0].classList.remove(options.classNames.block)\n  }\n\n  showStep(stepperNode, stepper._steps[indexStep], stepper._steps, options)\n  showContent(stepperNode, stepper._stepsContents[indexStep], stepper._stepsContents, activeContent, options)\n}\n\nconst showStep = (stepperNode, step, stepList, options) => {\n  stepList.forEach(step => {\n    const trigger = step.querySelector(options.selectors.trigger)\n\n    trigger.setAttribute('aria-selected', 'false')\n    // if stepper is in linear mode, set disabled attribute on the trigger\n    if (stepperNode.classList.contains(options.classNames.linear)) {\n      trigger.setAttribute('disabled', 'disabled')\n    }\n  })\n\n  step.classList.add(options.classNames.active)\n  const currentTrigger = step.querySelector(options.selectors.trigger)\n\n  currentTrigger.setAttribute('aria-selected', 'true')\n  // if stepper is in linear mode, remove disabled attribute on current\n  if (stepperNode.classList.contains(options.classNames.linear)) {\n    currentTrigger.removeAttribute('disabled')\n  }\n}\n\nconst showContent = (stepperNode, content, contentList, activeContent, options) => {\n  const shownEvent = createCustomEvent('shown.bs-stepper', {\n    cancelable: true,\n    detail: {\n      indexStep: contentList.indexOf(content)\n    }\n  })\n\n  function complete () {\n    content.classList.add(options.classNames.block)\n    content.removeEventListener(transitionEndEvent, complete)\n    stepperNode.dispatchEvent(shownEvent)\n  }\n\n  if (content.classList.contains(options.classNames.fade)) {\n    content.classList.remove(options.classNames.none)\n    const duration = getTransitionDurationFromElement(content)\n\n    content.addEventListener(transitionEndEvent, complete)\n    if (activeContent.length) {\n      activeContent[0].classList.add(options.classNames.none)\n    }\n\n    content.classList.add(options.classNames.active)\n    emulateTransitionEnd(content, duration)\n  } else {\n    content.classList.add(options.classNames.active)\n    stepperNode.dispatchEvent(shownEvent)\n  }\n}\n\nconst getTransitionDurationFromElement = element => {\n  if (!element) {\n    return 0\n  }\n\n  // Get transition-duration of the element\n  let transitionDuration = window.getComputedStyle(element).transitionDuration\n  const floatTransitionDuration = parseFloat(transitionDuration)\n\n  // Return 0 if element or transition duration is not found\n  if (!floatTransitionDuration) {\n    return 0\n  }\n\n  // If multiple durations are defined, take the first\n  transitionDuration = transitionDuration.split(',')[0]\n\n  return parseFloat(transitionDuration) * MILLISECONDS_MULTIPLIER\n}\n\nconst emulateTransitionEnd = (element, duration) => {\n  let called = false\n  const durationPadding = 5\n  const emulatedDuration = duration + durationPadding\n  function listener () {\n    called = true\n    element.removeEventListener(transitionEndEvent, listener)\n  }\n\n  element.addEventListener(transitionEndEvent, listener)\n  window.setTimeout(() => {\n    if (!called) {\n      element.dispatchEvent(WinEvent(transitionEndEvent))\n    }\n\n    element.removeEventListener(transitionEndEvent, listener)\n  }, emulatedDuration)\n}\n\nconst detectAnimation = (contentList, options) => {\n  if (options.animation) {\n    contentList.forEach(content => {\n      content.classList.add(options.classNames.fade)\n      content.classList.add(options.classNames.none)\n    })\n  }\n}\n\nexport {\n  show,\n  customProperty,\n  detectAnimation\n}\n","import { closest } from './polyfill'\nimport { customProperty, show } from './util'\n\nfunction buildClickStepLinearListener (options) {\n  return function clickStepLinearListener (event) {\n    event.preventDefault()\n  }\n}\n\nfunction buildClickStepNonLinearListener (options) {\n  return function clickStepNonLinearListener (event) {\n    event.preventDefault()\n\n    const step = closest(event.target, options.selectors.steps)\n    const stepperNode = closest(step, options.selectors.stepper)\n    const stepper = stepperNode[customProperty]\n    const stepIndex = stepper._steps.indexOf(step)\n\n    stepper._currentIndex = stepIndex\n    show(stepperNode, stepIndex, options)\n  }\n}\n\nexport {\n  buildClickStepLinearListener,\n  buildClickStepNonLinearListener\n}\n","import { show, customProperty, detectAnimation } from './util'\nimport { buildClickStepLinearListener, buildClickStepNonLinearListener } from './listeners'\n\nconst DEFAULT_OPTIONS = {\n  linear: true,\n  animation: false,\n  selectors: {\n    steps: '.step',\n    trigger: '.step-trigger',\n    stepper: '.bs-stepper'\n  },\n  classNames: {\n    active: 'active',\n    linear: 'linear',\n    block: 'dstepper-block',\n    none: 'dstepper-none',\n    fade: 'fade'\n  }\n}\n\nclass Stepper {\n  constructor (element, _options = {}) {\n    this._element = element\n    this._currentIndex = 0\n    this._stepsContents = []\n\n    this.options = {\n      ...DEFAULT_OPTIONS,\n      ..._options\n    }\n\n    // FIXME(ioxua-os): Find a better alternative to deep copy objects\n    this.options.selectors = {\n      ...DEFAULT_OPTIONS.selectors,\n      ...this.options.selectors\n    }\n\n    this.options.classNames = {\n      ...DEFAULT_OPTIONS.classNames,\n      ...this.options.classNames\n    }\n\n    if (this.options.linear) {\n      this._element.classList.add(this.options.classNames.linear)\n    }\n\n    this._steps = [].slice.call(this._element.querySelectorAll(this.options.selectors.steps))\n      .filter(step => step.hasAttribute('data-target'))\n\n    this._steps.forEach(step => {\n      this._stepsContents.push(\n        this._element.querySelector(step.getAttribute('data-target'))\n      )\n    })\n\n    detectAnimation(this._stepsContents, this.options)\n    this._setLinkListeners()\n    Object.defineProperty(this._element, customProperty, {\n      value: this,\n      writable: true\n    })\n\n    if (this._steps.length) {\n      show(this._element, this._currentIndex, this.options)\n    }\n  }\n\n  // Private\n\n  _setLinkListeners () {\n    this._steps.forEach(step => {\n      const trigger = step.querySelector(this.options.selectors.trigger)\n      if (this.options.linear) {\n        this._clickStepLinearListener = buildClickStepLinearListener(this.options)\n        trigger.addEventListener('click', this._clickStepLinearListener)\n      } else {\n        this._clickStepNonLinearListener = buildClickStepNonLinearListener(this.options)\n        trigger.addEventListener('click', this._clickStepNonLinearListener)\n      }\n    })\n  }\n\n  // Public\n\n  next () {\n    this._currentIndex = (this._currentIndex + 1) <= this._steps.length - 1 ? this._currentIndex + 1 : (this._steps.length - 1)\n\n    show(this._element, this._currentIndex, this.options)\n  }\n\n  previous () {\n    this._currentIndex = (this._currentIndex - 1) >= 0 ? this._currentIndex - 1 : 0\n\n    show(this._element, this._currentIndex, this.options)\n  }\n\n  to (stepNumber) {\n    const tempIndex = stepNumber - 1\n\n    this._currentIndex = tempIndex >= 0 && tempIndex < this._steps.length\n      ? tempIndex\n      : 0\n\n    show(this._element, this._currentIndex, this.options)\n  }\n\n  reset () {\n    this._currentIndex = 0\n    show(this._element, this._currentIndex, this.options)\n  }\n\n  destroy () {\n    this._steps.forEach(step => {\n      const trigger = step.querySelector(this.options.selectors.trigger)\n\n      if (this.options.linear) {\n        trigger.removeEventListener('click', this._clickStepLinearListener)\n      } else {\n        trigger.removeEventListener('click', this._clickStepNonLinearListener)\n      }\n    })\n\n    this._element[customProperty] = undefined\n    this._element = undefined\n    this._currentIndex = undefined\n    this._steps = undefined\n    this._stepsContents = undefined\n    this._clickStepLinearListener = undefined\n    this._clickStepNonLinearListener = undefined\n  }\n}\n\nexport default Stepper\n"],"names":["matches","window","Element","prototype","closest","element","selector","WinEvent","inType","params","Event","createCustomEvent","eventName","cEvent","CustomEvent","polyfill","msMatchesSelector","webkitMatchesSelector","document","documentElement","contains","call","parentElement","parentNode","nodeType","e","createEvent","initEvent","Boolean","bubbles","cancelable","originPreventDefault","preventDefault","evt","detail","initCustomEvent","Object","defineProperty","get","MILLISECONDS_MULTIPLIER","transitionEndEvent","customProperty","show","stepperNode","indexStep","options","stepper","_steps","classList","classNames","active","_stepsContents","showEvent","dispatchEvent","activeStep","filter","step","activeContent","content","defaultPrevented","length","remove","block","showStep","showContent","stepList","forEach","trigger","querySelector","selectors","setAttribute","linear","add","currentTrigger","removeAttribute","contentList","shownEvent","indexOf","complete","removeEventListener","fade","none","duration","getTransitionDurationFromElement","addEventListener","emulateTransitionEnd","transitionDuration","getComputedStyle","floatTransitionDuration","parseFloat","split","called","durationPadding","emulatedDuration","listener","setTimeout","detectAnimation","animation","buildClickStepLinearListener","clickStepLinearListener","event","buildClickStepNonLinearListener","clickStepNonLinearListener","target","steps","stepIndex","_currentIndex","DEFAULT_OPTIONS","Stepper","_options","_element","slice","querySelectorAll","hasAttribute","push","getAttribute","_setLinkListeners","value","writable","_clickStepLinearListener","_clickStepNonLinearListener","next","previous","to","stepNumber","tempIndex","reset","destroy","undefined"],"mappings":"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"}